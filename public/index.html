<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>üõçÔ∏è API REST - Backend de una tienda online ‚Äî Documentaci√≥n</title>
  <style>
    :root{
      --bg: #f8fafc;
      --card: #ffffff;
      --muted: #6b7280;
      --text: #0f172a;
      --accent: #0ea5a4;
      --mono-bg: #f3f4f6;
      --border: #e6e9ee;
    }
    html,body{height:100%}
    body{
      margin:20px;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background:var(--bg);
      color:var(--text);
      line-height:1.5;
    }
    header{margin-bottom:18px}
    h1{font-size:24px;margin:0 0 6px}
    p.lead{margin:0;color:var(--muted)}
    main{max-width:980px}
    section{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:10px;
      padding:18px;
      margin-bottom:16px;
      box-shadow: 0 6px 18px rgba(15,23,42,0.04);
    }
    h2{font-size:18px;margin:0 0 8px;color:var(--text)}
    ul{margin:8px 0 0 20px}
    pre, code { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", monospace; }
    code { background:var(--mono-bg); padding:2px 6px; border-radius:6px; font-size:13px; }
    pre{
      background:var(--mono-bg);
      padding:12px;
      border-radius:8px;
      margin-top:10px;
      overflow:auto;
      border:1px solid var(--border);
    }
    .muted { color: var(--muted); font-size:14px; }
    .cols{display:grid;grid-template-columns:1fr 320px;gap:14px}
    .aside{min-width:220px}
    .badge{display:inline-block;padding:6px 10px;border-radius:999px;background:rgba(14,165,164,0.08);color:var(--accent);font-weight:600;font-size:13px;margin-left:8px}
    .section-title{display:flex;align-items:center;gap:8px}
    footer{font-size:13px;color:var(--muted);margin-top:8px}
    @media (max-width:880px){ .cols{grid-template-columns:1fr} }
  </style>
</head>
<body>
  <main>
    <header>
      <h1>üõçÔ∏è API REST - Backend de una tienda online</h1>
      <p class="lead">Backend de una tienda online, implementado como API REST en <strong>Node.js + Express</strong> con <strong>MongoDB</strong>. Gesti√≥n de usuarios, productos y categor√≠as, autenticaci√≥n JWT, subida de im√°genes y organizaci√≥n mediante Clean Architecture + Patr√≥n Adaptador.</p>
    </header>

    <section>
      <div class="section-title">
        <h2>Caracter√≠sticas</h2>
        <span class="badge">Resumen</span>
      </div>
      <ul>
        <li>Creaci√≥n de usuarios, productos y categor√≠as.</li>
        <li>Paginaci√≥n en las peticiones <code>GET</code>.</li>
        <li>Registro e inicio de sesi√≥n con autenticaci√≥n mediante <strong>JWT</strong>.</li>
        <li>Validaci√≥n de usuarios mediante email (opcional ‚Äî configurable con variables de entorno y una secret key).</li>
        <li>Subida de archivos (guardados localmente).</li>
        <li>Registro en base de datos y <em>seed</em> para poblar la BBDD autom√°ticamente.</li>
      </ul>
    </section>

    <section class="cols">
      <div>
        <h2>Endpoints de autenticaci√≥n</h2>

        <h3>1. Registro ‚Äî <code>POST /api/auth/register</code></h3>
        <p class="muted">Body ejemplo:</p>
        <pre>{
  "name": "Pedro Pe√±as",
  "email": "pedropefer34@gmail.com",
  "password": "123456"
}</pre>

        <p class="muted">Respuesta ejemplo:</p>
        <pre>{
  "user": {
    "id": "68b042940097ed21ec39d2c3",
    "name": "Pedro Pe√±as",
    "email": "pedropefer34@gmail.com",
    "emailValidated": false,
    "role": ["USER_ROLE"]
  },
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}</pre>

        <h3>2. Login ‚Äî <code>POST /api/auth/login</code></h3>
        <p class="muted">Body ejemplo:</p>
        <pre>{ "email": "pedropefer34@gmail.com", "password": "123456" }</pre>

        <p class="muted">Respuesta ejemplo (mismo formato que registro):</p>
        <pre>{
  "user": { ... },
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}</pre>

        <h3>3. Uso del token</h3>
        <p class="muted">Enviar el JWT en el header <code>Authorization</code> como:</p>
        <pre>Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...</pre>

        <p class="muted">Este token ser√° necesario para crear productos y categor√≠as. Las rutas <code>GET</code> p√∫blicas no requieren autenticaci√≥n.</p>

        <hr style="margin:14px 0;border:none;border-top:1px solid var(--border)">

        <h2>Endpoints de productos y categor√≠as</h2>

        <h3>1. Creaci√≥n de categor√≠as ‚Äî <code>POST /api/categories</code></h3>
        <p class="muted">Body ejemplo:</p>
        <pre>{ "name": "Categor√≠a test", "available": "true" }</pre>

        <p class="muted">Sin token:</p>
        <pre>{ "error": "No token provided" }</pre>

        <p class="muted">Con token v√°lido ‚Äî respuesta ejemplo:</p>
        <pre>{
  "id": "68b045560097ed21ec39d2ca",
  "name": "Categor√≠a test",
  "available": true
}</pre>

        <h3>2. Obtenci√≥n de categor√≠as ‚Äî <code>GET /api/categories?page=1&amp;limit=2</code></h3>
        <p class="muted">Respuesta (paginada):</p>
        <pre>{
  "page": 1,
  "limit": 2,
  "total": 23,
  "next": "api/categories?page=2$limit=2",
  "prev": null,
  "categories": [
    {
      "id": "68b041bdc0a8edc42e3dbf0d",
      "name": "Driven",
      "available": false
    },
    {
      "id": "68b041bdc0a8edc42e3dbf0e",
      "name": "Till",
      "available": false
    }
  ]
}</pre>

        <h3>3. Creaci√≥n de productos ‚Äî <code>POST /api/products</code></h3>
        <p class="muted">Body ejemplo:</p>
        <pre>{
  "name": "Producto test",
  "category": "68b041bdc0a8edc42e3dbf0d"
}</pre>
        <p class="muted">Nota: la <code>category</code> debe ser un ID v√°lido de MongoDB para enlazarlos.</p>

        <p class="muted">Sin token:</p>
        <pre>{ "error": "No token provided" }</pre>

        <p class="muted">Con token v√°lido ‚Äî respuesta ejemplo:</p>
        <pre>{
  "name": "Producto test",
  "available": false,
  "price": 0,
  "user": "68b042940097ed21ec39d2c3",
  "category": "68b041bdc0a8edc42e3dbf0d",
  "id": "68b0481d0097ed21ec39d2f5"
}</pre>

        <p class="muted">Con autenticaci√≥n, se a√±ade el ID del usuario autenticado para saber qui√©n cre√≥ el producto.</p>

        <h3>4. Obtenci√≥n de productos ‚Äî <code>GET /api/products?limit=1&amp;page=1</code></h3>
        <p class="muted">Respuesta (paginada):</p>
        <pre>{
  "page": 1,
  "limit": 1,
  "total": 23,
  "next": "api/categories?page=2$limit=1",
  "prev": null,
  "products": [
    {
      "name": "Than",
      "available": true,
      "price": 75.0369,
      "user": {
        "name": "Test 2",
        "email": "test2@google.com",
        "emailValidated": false,
        "role": ["USER_ROLE"],
        "id": "68b041bdc0a8edc42e3dbf07"
      },
      "category": {
        "name": "kitchen",
        "id": "68b041bdc0a8edc42e3dbf1f"
      },
      "id": "68b041bdc0a8edc42e3dbf26"
    }
  ]
}</pre>

      </div>

      <aside class="aside">
        <h3>Nota r√°pida</h3>
        <p class="muted">Las rutas de lectura (<code>GET</code>) suelen ser p√∫blicas; las de creaci√≥n/actualizaci√≥n/eliminaci√≥n requieren autenticaci√≥n.</p>
        <h3 style="margin-top:12px">Paginaci√≥n</h3>
        <p class="muted">Se usan par√°metros <code>page</code> y <code>limit</code> en la query-string para controlar la paginaci√≥n.</p>
      </aside>
    </section>

    <section>
      <h2>Endpoints de carga de im√°genes</h2>

      <h3>1. Carga simple (una sola imagen) ‚Äî <code>POST /api/upload/single/:type</code></h3>
      <p class="muted">Reemplazar <code>:type</code> por la clase de la imagen: <code>users</code>, <code>products</code> o <code>categories</code>.</p>
      <p class="muted">Permitir formatos: <code>png</code>, <code>jpeg</code>, <code>jpg</code>, <code>gif</code>.</p>

      <p class="muted">Respuesta ejemplo:</p>
      <pre>{
  "fileName": "0029b869-a5ac-4d5a-8154-c8e6a0d2c182.png"
}</pre>
      <p class="muted">La imagen se guarda en la carpeta <code>uploads</code> del proyecto, dentro del subdirectorio indicado por <code>:type</code>.</p>

      <h3>2. Carga m√∫ltiple (varias im√°genes) ‚Äî <code>POST /api/upload/multiple/:type</code></h3>
      <p class="muted">Funciona de forma similar al anterior pero permite varios archivos simult√°neos.</p>

      <h3>3. Obtener imagen ‚Äî <code>GET /api/images/:type/:img</code></h3>
      <p class="muted">Reemplazar <code>:type</code> por <code>users</code> | <code>products</code> | <code>categories</code> y <code>:img</code> por el nombre o ID del archivo almacenado.</p>
      <p class="muted">La respuesta es el propio recurso de la imagen (binary/image).</p>
    </section>

    <section>
      <h2>Tecnolog√≠as</h2>
      <ul>
        <li><strong>Node.js + Express</strong> (API REST)</li>
        <li><strong>JWT</strong> (autenticaci√≥n)</li>
        <li><strong>MongoDB</strong> (base de datos)</li>
        <li><strong>Mongoose</strong> (ODM)</li>
        <li><strong>Bcrypt</strong> (hash de contrase√±as)</li>
        <li><strong>Dotenv</strong> (variables de entorno)</li>
        <li><strong>Uuid</strong> (generaci√≥n de IDs para archivos)</li>
        <li><strong>Nodemailer</strong> (env√≠o de correos ‚Äî validaci√≥n de email)</li>
        <li><strong>Express-fileupload</strong> (subida de archivos)</li>
        <li><strong>Clean Architecture</strong> + <strong>Patr√≥n Adaptador</strong></li>
      </ul>
    </section>

    <section>
      <h2>Instalaci√≥n</h2>

      <p class="muted"><strong>Paso a paso:</strong></p>

      <pre>
# Clonar repositorio
Clonar '.env.template' a '.env' y configurar las variables de entorno

# Instalar dependencias
Ejecutar el comando 'npm install'

# Base de datos
Configurar el 'docker-compose.yml' y ejecutar 'docker compose up -d' para levantar los servicios deseados.

# Llenar base de datos
Llenar la base de datos con los datos de prueba ejecutando 'npm run seed'

# Levantar el proyecto
Ejecutar 'npm run dev' para levantar el proyecto en modo desarrollo
      </pre>

      <p class="muted">Aseg√∫rate de configurar correctamente en <code>.env</code> las variables de conexi√≥n a MongoDB, la <code>SECRET_KEY</code> para JWT y, si usas validaci√≥n por email, los credenciales SMTP para <code>Nodemailer</code>.</p>
    </section>

    <section>
      <h2>Consejos / Buenas pr√°cticas</h2>
      <ul>
        <li>Usar HTTPS en producci√≥n.</li>
        <li>No exponer <code>.env</code> ni secrets en el repositorio.</li>
        <li>Validar y sanear datos de entrada (evitar inyecciones y uploads peligrosos).</li>
        <li>Limitar tama√±o y tipos de archivos aceptados para uploads.</li>
        <li>Separar responsabilidades siguiendo Clean Architecture (domain, application, infrastructure, interfaces).</li>
        <li>Registrar logs y manejar errores centralizados con un middleware de error.</li>
      </ul>
    </section>

    <footer>
      <div>Licencia: MIT</div>
      <div style="margin-top:6px" class="muted">Este documento reproduce la estructura y contenido del README que has proporcionado para usarlo como documentaci√≥n HTML est√°tica.</div>
    </footer>
  </main>
</body>
</html>
